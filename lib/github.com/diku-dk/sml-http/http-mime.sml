structure HttpMime :> sig
  type t
  val fromString : string -> t option
  val desc       : t -> string
  val fromExt    : string -> t option
  val toString   : t -> string
end =
struct

type t = string

fun toString x = x

val fromExt =
 fn ".aac" => SOME "audio/aac"
  | ".abw" => SOME "application/x-abiword"
  | ".arc" => SOME "application/x-freearc"
  | ".avi" => SOME "video/x-msvideo"
  | ".azw" => SOME "application/vnd.amazon.ebook"
  | ".bin" => SOME "application/octet-stream"
  | ".bmp" => SOME "image/bmp"
  | ".bz" => SOME "application/x-bzip"
  | ".bz2" => SOME "application/x-bzip2"
  | ".cda" => SOME "application/x-cdf"
  | ".csh" => SOME "application/x-csh"
  | ".css" => SOME "text/css"
  | ".csv" => SOME "text/csv"
  | ".doc" => SOME "application/msword"
  | ".docx" => SOME "application/vnd.openxmlformats-officedocument.wordprocessingml.document"
  | ".eot" => SOME "application/vnd.ms-fontobject"
  | ".epub" => SOME "application/epub+zip"
  | ".gz" => SOME "application/gzip"
  | ".gif" => SOME "image/gif"
  | ".htm" => SOME "text/html"
  | ".html" => SOME "text/html"
  | ".ico" => SOME "image/vnd.microsoft.icon"
  | ".ics" => SOME "text/calendar"
  | ".jar" => SOME "application/java-archive"
  | ".jpeg" => SOME "image/jpeg"
  | ".jpg" => SOME "image/jpeg"
  | ".js" => SOME "text/javascript"
  | ".json" => SOME "application/json"
  | ".jsonld" => SOME "application/ld+json"
  | ".mid" => SOME "audio/midi"
  | ".midi" => SOME "audio/x-midi"
  | ".mjs" => SOME "text/javascript"
  | ".mp3" => SOME "audio/mpeg"
  | ".mp4" => SOME "video/mp4"
  | ".mpeg" => SOME "video/mpeg"
  | ".mpkg" => SOME "application/vnd.apple.installer+xml"
  | ".odp" => SOME "application/vnd.oasis.opendocument.presentation"
  | ".ods" => SOME "application/vnd.oasis.opendocument.spreadsheet"
  | ".odt" => SOME "application/vnd.oasis.opendocument.text"
  | ".oga" => SOME "audio/ogg"
  | ".ogv" => SOME "video/ogg"
  | ".ogx" => SOME "application/ogg"
  | ".opus" => SOME "audio/opus"
  | ".otf" => SOME "font/otf"
  | ".png" => SOME "image/png"
  | ".pdf" => SOME "application/pdf"
  | ".php" => SOME "application/x-httpd-php"
  | ".ppt" => SOME "application/vnd.ms-powerpoint"
  | ".pptx" => SOME "application/vnd.openxmlformats-officedocument.presentationml.presentation"
  | ".rar" => SOME "application/vnd.rar"
  | ".rtf" => SOME "application/rtf"
  | ".sh" => SOME "application/x-sh"
  | ".svg" => SOME "image/svg+xml"
  | ".swf" => SOME "application/x-shockwave-flash"
  | ".tar" => SOME "application/x-tar"
  | ".tif" => SOME "image/tiff"
  | ".tiff" => SOME "image/tiff"
  | ".ts" => SOME "video/mp2t"
  | ".ttf" => SOME "font/ttf"
  | ".txt" => SOME "text/plain"
  | ".vsd" => SOME "application/vnd.visio"
  | ".wav" => SOME "audio/wav"
  | ".weba" => SOME "audio/webm"
  | ".webm" => SOME "video/webm"
  | ".webp" => SOME "image/webp"
  | ".woff" => SOME "font/woff"
  | ".woff2" => SOME "font/woff2"
  | ".xhtml" => SOME "application/xhtml+xml"
  | ".xls" => SOME "application/vnd.ms-excel"
  | ".xlsx" => SOME "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
  | ".xml" => SOME "application/xml"
  | ".xul" => SOME "application/vnd.mozilla.xul+xml"
  | ".zip" => SOME "application/zip"
  | ".3gp" => SOME "video/3gpp"
  | ".3g2" => SOME "video/3gpp2"
  | ".7z" => SOME "application/x-7z-compressed"
  | _ => NONE

val desc0 =
 fn "audio/aac" => SOME "AAC audio"
  | "application/x-abiword" => SOME "AbiWord document"
  | "application/x-freearc" => SOME "Archive document (multiple files embedded)"
  | "video/x-msvideo" => SOME "AVI: Audio Video Interleave"
  | "application/vnd.amazon.ebook" => SOME "Amazon Kindle eBook format"
  | "application/octet-stream" => SOME "Any kind of binary data"
  | "image/bmp" => SOME "Windows OS/2 Bitmap Graphics"
  | "application/x-bzip" => SOME "BZip archive"
  | "application/x-bzip2" => SOME "BZip2 archive"
  | "application/x-cdf" => SOME "CD audio"
  | "application/x-csh" => SOME "C-Shell script"
  | "text/css" => SOME "Cascading Style Sheets (CSS)"
  | "text/csv" => SOME "Comma-separated values (CSV)"
  | "application/msword" => SOME "Microsoft Word"
  | "application/vnd.openxmlformats-officedocument.wordprocessingml.document" => SOME "Microsoft Word (OpenXML)"
  | "application/vnd.ms-fontobject" => SOME "MS Embedded OpenType fonts"
  | "application/epub+zip" => SOME "Electronic publication (EPUB)"
  | "application/gzip" => SOME "GZip Compressed Archive"
  | "image/gif" => SOME "Graphics Interchange Format (GIF)"
  | "text/html" => SOME "HyperText Markup Language (HTML)"
  | "image/vnd.microsoft.icon" => SOME "Icon format"
  | "text/calendar" => SOME "iCalendar format"
  | "application/java-archive" => SOME "Java Archive (JAR)"
  | "image/jpeg" => SOME "JPEG images"
  | "text/javascript" => SOME "JavaScript"
  | "application/json" => SOME "JSON format"
  | "application/ld+json" => SOME "JSON-LD format"
  | "audio/midi" => SOME "Musical Instrument Digital Interface (MIDI)"
  | "audio/x-midi" => SOME "Musical Instrument Digital Interface (MIDI)"
  | "audio/mpeg" => SOME "MP3 audio"
  | "video/mp4" => SOME "MP4 video"
  | "video/mpeg" => SOME "MPEG Video"
  | "application/vnd.apple.installer+xml" => SOME "Apple Installer Package"
  | "application/vnd.oasis.opendocument.presentation" => SOME "OpenDocument presentation document"
  | "application/vnd.oasis.opendocument.spreadsheet" => SOME "OpenDocument spreadsheet document"
  | "application/vnd.oasis.opendocument.text" => SOME "OpenDocument text document"
  | "audio/ogg" => SOME "OGG audio"
  | "video/ogg" => SOME "OGG video"
  | "application/ogg" => SOME "OGG"
  | "audio/opus" => SOME "Opus audio"
  | "font/otf" => SOME "OpenType font"
  | "image/png" => SOME "Portable Network Graphics"
  | "application/pdf" => SOME "Adobe Portable Document Format (PDF)"
  | "application/x-httpd-php" => SOME "Hypertext Preprocessor (Personal Home Page)"
  | "application/vnd.ms-powerpoint" => SOME "Microsoft PowerPoint"
  | "application/vnd.openxmlformats-officedocument.presentationml.presentation" => SOME "Microsoft PowerPoint (OpenXML)"
  | "application/vnd.rar" => SOME "RAR archive"
  | "application/rtf" => SOME "Rich Text Format (RTF)"
  | "application/x-sh" => SOME "Bourne shell script"
  | "image/svg+xml" => SOME "Scalable Vector Graphics (SVG)"
  | "application/x-shockwave-flash" => SOME "Small web format (SWF) or Adobe Flash document"
  | "application/x-tar" => SOME "Tape Archive (TAR)"
  | "image/tiff" => SOME "Tagged Image File Format (TIFF)"
  | "video/mp2t" => SOME "MPEG transport stream"
  | "font/ttf" => SOME "TrueType Font"
  | "text/plain" => SOME "Text, (generally ASCII or ISO 8859-n)"
  | "application/vnd.visio" => SOME "Microsoft Visio"
  | "audio/wav" => SOME "Waveform Audio Format"
  | "audio/webm" => SOME "WEBM audio"
  | "video/webm" => SOME "WEBM video"
  | "image/webp" => SOME "WEBP image"
  | "font/woff" => SOME "Web Open Font Format (WOFF)"
  | "font/woff2" => SOME "Web Open Font Format (WOFF)"
  | "application/xhtml+xml" => SOME "XHTML"
  | "application/vnd.ms-excel" => SOME "Microsoft Excel"
  | "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" => SOME "Microsoft Excel (OpenXML)"
  | "application/xml" => SOME "XML"
  | "application/vnd.mozilla.xul+xml" => SOME "XUL"
  | "application/zip" => SOME "ZIP archive"
  | "video/3gpp" => SOME "3GPP video container"
  | "video/3gpp2" => SOME "3GPP2 video container"
  | "audio/3gpp" => SOME "3GPP audio container"
  | "audio/3gpp2" => SOME "3GPP2 audio container"
  | "application/x-7z-compressed" => SOME "7-zip archive"
  | _ => NONE

fun fromString t =
    case desc0 t of
        SOME _ => SOME t
      | NONE => NONE

fun desc t =
    case desc0 t of
        SOME d => d
      | NONE => raise Fail "HttpMime.desc: impossible"
end
